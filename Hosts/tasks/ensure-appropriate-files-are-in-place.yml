- name: Ensure inventory directory exists
  file:
    path: ~/.HAB/inventory/
    state: directory
- name: Ensure vanilla-hosts exists appropriately
  become: false
  blockinfile:
    path: ~/.HAB/inventory/vanilla-hosts
    insertbefore: BOF
    marker: "{mark}"
    marker_begin: |-
      ###########################################
    block: |-
      #  -*- Complete List of Vanilla Hosts -*- #
      # Editing hosts below is welcome, but be sure to validate after with command: `ansible-playbook standup-vanilla-hosts.yml`
      # HOWEVER, once you have live hosts, you can do a great deal of damage to your cluster if you edit this file.
      # ONLY EDIT AND VALIDATE BEFORE STANDING UP VANILLA K3S
      # DO NOT EDIT THIS COMMENT BLOCK AND THE FOLLOWING LINE "[vanillahosts]": MANGED BY ANSIBLE!
      ############################################
    marker_end: |-
      [vanillahosts]
    create: yes

- name: Ensure host-plan.tpl exist appropriately - top half
  become: false
  blockinfile:
    path: ~/.HAB/inventory/host-plan.tpl
    insertbefore: BOF
    marker: "{mark}"
    marker_begin: |-
      ###############################################################################
    block: |+
      #                      -*- HAB Host Plan Template -*-                         #
      #                                                                             #
      #   WARNING: DO NOT EDIT THIS FILE (host-plan.tpl) IT IS MANAGED BY ANSIBLE   #
      #                                                                             #
      # Assign your vanilla hosts to the roles that you would like them to have by  #
      # moving them (cut/paste) from inventory to under a group definition          #
      # 1. The host must be uncommented to be activated (remove the '#' at the      #
      #    start of the line)                                                       #
      # 2. You do not need to activate all hosts                                    #
      # 3. At this point in the game, you should not change anything inside the     #
      #    host definition line, only change its location                           #
      # 4. Consult the ReadMe for all the info about validation rules, extra help,  #
      #    and examples                                                             #
    marker_end: |-
      #                       -*- Unassigned Inventory -*-                          #
    create: yes
- name: Ensure host-plan.tpl exist appropriately - bottom half
  blockinfile:
    path: ~/.HAB/inventory/host-plan.tpl
    insertafter: EOF
    marker: "{mark}"
    marker_begin: |-
      #                   -*- End Of Unassigned Inventory -*-                       #
    block: |+

      [leader]

      [lieutenants]


    marker_end: |-
      [workers]
